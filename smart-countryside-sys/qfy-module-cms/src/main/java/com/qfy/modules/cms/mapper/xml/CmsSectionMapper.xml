<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qfy.modules.cms.mapper.CmsSectionMapper">

	<update id="updateTreeNodeStatus" parameterType="java.lang.String">
		update qfy_cms_section set has_child = #{status} where id = #{id}
	</update>


	<select id="queryListByPid" parameterType="Object" resultType="org.jeecg.modules.system.model.TreeSelectModel">
		select name_code as code,
		name as "title",
		id as "key",
		(case when has_child = '1' then 0 else 1 end) as isLeaf,
		pid as parentId
		from qfy_cms_section
		where pid = #{pid}
		<if test="query!= null">

			<if test="query.name !=null and query.name != ''">
				and name = #{query.name}
			</if>

			<if test="query.id !=null and query.id != ''">
				and id = #{query.id}
			</if>

			<if test="query.createBy !=null and query.createBy != ''">
				and create_by = #{query.createBy}
			</if>

			<if test="query.sysOrgCode !=null and query.sysOrgCode != ''">
				and sys_org_code = #{query.sysOrgCode}
			</if>
		</if>
	</select>

</mapper>
